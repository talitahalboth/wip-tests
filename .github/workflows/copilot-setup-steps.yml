name: "Copilot Setup Steps"

# Automatically run the setup steps when they are changed to allow for easy validation, and
# allow manual testing through the repository's "Actions" tab
on:
  workflow_dispatch:
  push:
    paths:
      - .github/workflows/copilot-setup-steps.yml
  pull_request:
    paths:
      - .github/workflows/copilot-setup-steps.yml

jobs:
  # The job MUST be called `copilot-setup-steps` or it will not be picked up by Copilot.
  copilot-setup-steps:
    name: Setup Copilot
    permissions:
      contents: read
      packages: read
    runs-on: ubuntu-latest

    # container:
    #   image: ubuntu:latest      
    #   env:
    #       MOUNTED_TARGET_DIR: /target
    #       MOUNTED_TESTS_DIR: /test-results
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: Install dependencies
      run: |
        if [ -f package.json ]; then
          npm ci
        else
          echo "No package.json found, skipping npm install"
        fi
        
    - name: Verify Copilot environment
      run: |
        echo "=== Environment Information ==="
        echo "Node version: $(node --version)"
        echo "npm version: $(npm --version)"
        echo "Current directory: $(pwd)"
        echo "=== Repository Structure ==="
        find . -type f -name "*.js" -o -name "*.ts" -o -name "*.json" -o -name "*.md" | head -20
        
    - name: Run basic validation
      run: |
        echo "=== Basic Validation ==="
        echo "Repository validation completed successfully"
        echo "Copilot setup steps executed"


